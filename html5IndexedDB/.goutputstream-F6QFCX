<html>
  <head>
    <title>Agenda</title>
    <link rel="stylesheet" type="text/css" href="style.css">
  <script>
    function afegir(){
		var nom = document.getElementById("nom");
		var descripcio = document.getElementById("descripcio");
		var importancia = document.getElementById("importancia");
		var temps = document.getElementById("temps");
		var task = {
			nom: nom.value, 
			descripcio:descripcio.value, 
			importancia:importancia.value, 
			temps:temps.value
			};
			// vars
		var html5rocks = {};
		html5rocks.indexedDB = {};
		// obrim bd
		html5rocks.indexedDB.db = null;

		html5rocks.indexedDB.open = function() {
		  var request = indexedDB.open("agenda2");

		  request.onsuccess = function(e) {
			html5rocks.indexedDB.db = e.target.result;
			// Do some more stuff in a minute
		  };

		  request.onfailure = html5rocks.indexedDB.onerror;
		};
		// -- //
		// Creem almacen de dades
		html5rocks.indexedDB.open = function() {
		  var request = indexedDB.open("agenda",
			"Agenda de tareas pendientes");

		  request.onsuccess = function(e) {
			var v = "1.0";
			html5rocks.indexedDB.db = e.target.result;
			var db = html5rocks.indexedDB.db;
			// We can only create Object stores in a setVersion transaction;
			if(v!= db.version) {
			  var setVrequest = db.setVersion(v);

			  // onsuccess is the only place we can create Object Stores
			  setVrequest.onfailure = html5rocks.indexedDB.onerror;
			  setVrequest.onsuccess = function(e) {
				var store = db.createObjectStore("tareas",
				  {keyPath: "tarea"});

				html5rocks.indexedDB.getAllTodoItems();
			  };
			}

			html5rocks.indexedDB.getAllTodoItems();
		  };

		  request.onfailure = html5rocks.indexedDB.onerror;
		}
		// -- //
		// Afegim dades en un almacen dobjectes
		html5rocks.indexedDB.addTodo = function(todoText) {
		  var db = html5rocks.indexedDB.db;
		  var trans = db.transaction(["todo"], IDBTransaction.READ_WRITE, 0);
		  var store = trans.objectStore("todo");
		  var request = store.put({
			"text": todoText,
			"timeStamp" : new Date().getTime()
		  });

		  request.onsuccess = function(e) {
			// Re-render all the todo's
			html5rocks.indexedDB.getAllTodoItems();
		  };

		  request.onerror = function(e) {
			console.log(e.value);
		  };
		};
		
		// -- //
				
		nom.value = ""; descripcio.value = ""; importancia.value=""; temps.value="";
		
		
	}
	
		/*
		task = [{tarea: nom, desc:descripcio, imp:importancia, time:temps}];
		peticion.onsuccess=function(event){
			var contenedor = bbdd.createObjectStore("tareas", {keyPath:"tarea"});
			contenedor.createIndex("tarea","tarea", {unique:true});
			for (n in task){
				contenedor.add(task[n]);
			}
		};*/
  </script>
  </head>
  <body>
	  <div class="CSSTableGenerator" >
	  <table >
		<tr>
			<td >
				Nom de la tarea
			</td>
			<td>
				Descripcio
			</td>
			<td>
				Importancia
			</td>
			<td>
				Hores
			</td>
		</tr>
			<tr>
			<td >
				<label><input  class="form-field" type="text" name="nom" id="nom" maxlength="20" size="20"> <span id="altreDiv"> </span> </label>
			</td>
			<td>
				<label><input  class="form-field" type="text" name="descripcio" id="descripcio" maxlength="20" size="20"> <span id="altreDiv" > </span> </label>
			</td>
			<td>
				<label><input  class="form-field" type="text" name="importancia" id="importancia" maxlength="10" size="10"> <span id="altreDiv" > </span> </label>
			</td>
			<td>
				<label><input  class="form-field" type="text" name="temps" id="temps" maxlength="10" size="10"> <span id="altreDiv" > </span> </label>
			</td>
		</tr>
	</table>
	<input type="submit" value="Afegir" class="buto" onClick="afegir()" id="afegir">
	</div>
  </body>
</html>
